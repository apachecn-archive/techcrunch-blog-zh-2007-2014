# Twitter 攻击剖析

> 原文：<https://web.archive.org/web/https://techcrunch.com/2009/07/19/the-anatomy-of-the-twitter-attack/>

![](img/eafcce80908abb00dd21909ee7066f75.png)

推特文件泄露的惨败从一个简单的故事开始，推特员工的个人账户被黑。Twitter 首席执行官伊万·威廉姆斯对此事发表评论，称 Twitter 本身基本上没有受到影响。没有个人账户被泄露，*“大多数敏感信息是个人的，而不是与公司相关的，”*他说。黑客克罗尔(Hacker Croll)是这些攻击的幕后黑手，他对这种反应并不满意。许多 Twitter 公司信息被泄露，他希望全世界都知道这件事。所以他[把他获得的所有文件](https://web.archive.org/web/20230306024837/https://techcrunch.com/2009/07/14/in-our-inbox-hundreds-of-confidential-twitter-documents/)都发给了我们，大约 310 份，然后[的故事就从那里展开](https://web.archive.org/web/20230306024837/https://techcrunch.com/2009/07/15/our-reaction-to-your-reactions-on-the-twitter-confidential-documents-post/)。

这篇文章不是关于推特上的机密信息。这是关于黑客克罗尔最初是如何能够如此深入地访问 Twitter 的。

很明显，Twitter 完全不知道他们作为一家公司受到了多么深的影响——当威廉姆斯说大多数信息与公司无关时，他相信了。直到后来，他才意识到到底有多少和什么样的信息被窃取了。它包括像[财务预测](https://web.archive.org/web/20230306024837/https://techcrunch.com/2009/07/15/twitters-financial-forecast-shows-first-revenue-in-q3-1-billion-users-in-2013/)和[高管会议记录](https://web.archive.org/web/20230306024837/https://techcrunch.com/2009/07/16/twitters-internal-strategy-laid-bare-to-be-the-pulse-of-the-planet/)这样包含高度机密信息的东西。

我们已经说了很多关于这一切和相关的“[服务器密码=密码](https://web.archive.org/web/20230306024837/https://techcrunch.com/2009/07/15/another-security-tip-for-twitter-dont-use-password-as-your-password/)”的故事，这是上周由另一个人发现的。但是我们还有两个故事要讲。第一篇文章，这篇文章，基于从与黑客克罗尔数小时的谈话中收集到的信息，准确地描述了黑客攻击是如何发生的。第二是随着故事的展开，在 Twitter 的幕后发生了什么。我们将在本周晚些时候发布。

当这个故事第一次被揭露时，发生了什么事情的真实范围以及它是如何发生的还不被理解。各种各样的博客作者对攻击的原因进行了猜测——一些人将责任归咎于谷歌，而另一些人则归咎于在云端托管文件的上升趋势。

我们立即将我们掌握的信息通知了 Twitter(并转发给了他们)，同时联系了攻击者。令人信服的是，入侵 Twitter 的攻击者开始与我们对话。我花了几天时间与攻击者沟通，试图深入了解攻击是如何发生的，攻击的真实范围是什么，以及我们如何从中吸取教训。

我们一直等到 Twitter 有时间关闭所有这些安全漏洞时，才公布到底发生了什么。

**一些背景**

在安全行业，有一个普遍接受的理念，即没有系统或网络是完全安全的-一个有足够时间、耐心和资源的合格攻击者最终会找到进入目标的方法。一些更著名的信息安全漏洞仅仅依赖于攻击者利用的基本问题，攻击者手头有足够的时间和耐心来实现他们的目标。一个经典的例子是[加里·麦金农](https://web.archive.org/web/20230306024837/http://en.wikipedia.org/wiki/Gary_McKinnon)，一个自称“笨手笨脚的电脑呆子”的人，虽然经常喝醉，吸食大麻，但他会花几天时间随机拨号或试图使用默认密码登录政府服务器。他的努力导致许多政府部门的近 100 台服务器遭到破坏。在麦金农花了几年时间在服务器上搜寻外星生命的证据(说来话长)后，政府内部有人终于知道了他的活动，这不仅导致了麦金农被逮捕并试图从英国引渡，还导致了对用于保护政府信息的安全方法的大规模重新评估。

最近的一个例子是肯德尔·迈尔斯(Kendall Myers)的案件，他被一个在古巴度假时认识的匿名陌生人招募为古巴政府工作，并着手在国务院获得一个高级职位，专门获取美国政府的机密。肯德尔一生致力于获取国家机密，直到最近被联邦调查局抓获，他已经成功地向古巴政府传递秘密信息和内部文件长达 30 年。他只依靠自己的记忆、学历和纯粹的奉献精神。

**推特攻击:生态系统如何失败**

像其他成功的攻击一样，黑客克罗尔使用了同样的耐心、纯粹的决心和有点简单的方法来获得与 Twitter 和 Twitter 员工有关的数量惊人的账户和服务。受到直接或间接影响的服务包括一些目前最流行的网络应用和服务——Gmail、Google Apps、GoDaddy、MobileMe、美国电话电报公司、亚马逊、Hotmail、Paypal 和 iTunes。单独来看，这些服务中的大多数都有合理的安全防范措施来防范入侵。但是把它们放在一起看，作为一个生态系统，有很大的弱点。就像多米诺骨牌一样，一旦一个倒下(Gmail 是第一个倒下的)，其他的也会跟着倒下。最终的结果是混乱，并提出了重要的问题，即在越来越多的数据、应用程序和整个用户身份托管在网络和“云中”的时代，如何管理和保护私人企业和个人信息。

“Hacker Croll”是一名 20 岁出头的法国人。他目前居住在一个欧洲国家，两年多前首次发现自己对 web 安全感兴趣。目前，在工作之余，他利用他现在拥有的额外时间，以及他获得的技能，通过网络侵入公司和个人账户。他的网络安全知识是通过结合公众可获得的材料和一个紧密团结的黑客伙伴团体内获得的，他们交流新的、有时是未知的技术和漏洞的细节。尽管一次成功的攻击意义重大，影响深远，黑客声称他的主要动机是好奇、探索和对网络安全的兴趣的结合。在这些人当中几乎有一种窥淫癖的倾向，因为他们陶醉于获得个人和公司内部生活信息的特权的想法。访问和获得未经授权的知识的“高度”必须足够大，才能让破解者有动力通过数小时、数天、数月的努力来获得下一桶金。

对黑客克罗尔来说，他进入目标网络的第一站是利用公共搜索引擎和公共信息来建立公司或个人的档案。在 Twitter 受到攻击的情况下，这些公开信息使他能够创建一个丰富的数据目录，其中包括员工姓名、相关电子邮件地址以及他们在公司中的角色。像出生日期、宠物的名字和其他看似无辜的数据也被发现和记录。这张覆盖数百万网页的搜索网收集了每个被发现的名字的工作和个人信息。网络上的公共信息没有概念，也没有能力区分一个人身份的工作和个人细节——因此从一个研究任务的黑客的角度来看，让目标的数字生活的商业和个人方面交织在一起只会提供额外的潜在切入点。

随着他的目标的制定，Hacker Croll 知道他可能只需要在他的列表中的任何一个企业或个人帐户中有一个入口点，就可以渗透到网络中，然后扩散到其他帐户和企业的其他部分。这是因为网络是在参与者之间存在绝对信任的时代设计的——不需要集中或正式的识别机制。为了保持私人数据的私密性，现代网络应用程序已经建立了自己的系统和政策，要求用户注册，然后使用每个应用程序单独管理他们的身份。大多数应用程序使用的标识符是电子邮件地址，正是这个共同因素在用户的应用程序之间创建了事实上的信任关系。第二个因素是密码:一个只有用户知道的随机字符串，对每个应用程序都是唯一的，从理论上讲，计算机甚至需要几个月或几年才能知道它是否开始猜测。这两个因素在大多数情况下都足够了，如果不是因为一个最弱的因素:人类习惯。

看看几乎所有网络应用的首页，你就会发现我们在管理数字生活时是多么绝望和无助:“忘记了密码”、“忘记了用户名”、“让我保持登录”、“不要让我保持登录”、“忘记了我的名字”、“我是谁？”。这些功能是作为一种妥协而设计和构建的，因为我们经常无法记住一个四位数的 PIN 码，更不用说我们注册的每个应用程序的唯一密码了。用户注册的每一项新服务都会产生管理开销，这种开销很快就会变成随处使用简单密码的习惯。在这种情况下，用户整个在线身份的安全性只与他们使用的最弱的应用程序一样强，也就是说，非常弱。

现在回到 Hacker Croll 和他的 Twitter 员工名单以及其他信息。Twitter 恰好是几乎所有业务都在网上的新型公司之一。作为工作的一部分，这些员工中的每一个都与其他员工共享数据——无论是通过特定应用程序的功能，还是仅仅通过电子邮件。随着这些用户变得交织在一起，它增加了一个全新的攻击媒介，链中的弱点不再仅仅是最弱的应用程序，而是最弱的用户使用的最弱的应用程序。对于黑客 Croll 这样的攻击者来说，他试图利用不良用户习惯、糟糕的功能实现以及用户混合个人和商业数据的组合，他成功的机会会成倍增加。大量基于网络的公司很大程度上依赖于用户能够管理自己——这不仅不利于 Twitter，也不利于大多数采用这种模式的公司。

对 Twitter 来说不幸的是，黑客 Croll 找到了这样一个弱点。一名员工的上网习惯可能与 98%的其他网络用户没有什么不同。它始于这位员工的个人 Gmail 账户。与大多数其他网络应用程序一样，Gmail 个人版具有密码恢复功能，该功能会向用户提出一系列挑战来证明他们的身份，以便他们可以重置密码。这可能不是黑客克罗尔试图进入的第一个 Twitter 员工的账户，但在这个特殊的账户中，他发现了一个让他迈出了重要的第一步的扭结。在请求恢复密码时，Gmail 通知他，一封电子邮件已经发送到用户的第二个电子邮件帐户。为了平衡可用性和安全性，Gmail 提供了一个提示，告诉用户重设密码的邮件将发送到哪个账户，以防用户需要一个温和的提醒。在这种情况下，指向第二电子邮件帐户位置的模糊指针是******@h******.com。最自然的猜测是，第二电子邮件帐户托管在 hotmail.com。

在 Hotmail，黑客 Croll 再次尝试了密码恢复程序——根据他已经知道的信息对用户名进行了有根据的猜测。这是信任链中断的地方，因为攻击者发现指定为 Gmail 二级帐户并托管在 Hotmail 的帐户不再活跃。这是由于 Hotmail 的政策，旧的和休眠的帐户被删除和回收。他注册了账户，重新申请了 Gmail 的密码恢复功能，不一会儿就进入了一名 Twitter 员工的个人 Gmail 账户。第一块多米诺骨牌倒下了。

设计良好的 web 应用程序绝不会只给用户密码，如果他们忘记了，他们会强迫用户选择一个新的。黑客克罗尔可以进入这个账户，但是要用他指定的密码。为了不提醒账户所有者他们的账户已经被攻破，他必须想办法找出旧的 Gmail 密码，并将其重置。他现在手边有一大堆信息，一个完整的邮箱和一个电子邮件账户的控制权。没过多久，他就发现了一封类似这样的电子邮件:

> 收件人:懒惰用户
> 发件人:超级骗子网络服务
> 主题:感谢您注册超级骗子网络服务
> 
> 亲爱的懒惰用户:
> 
> 感谢您注册 Super Duper Web 服务。为了我们的支持部门(以及其他正在阅读本文的人)的利益，请在下面找到您的帐户信息:
> 
> 用户名:LazyUser
> 密码:funsticks
> 
> 要重置您的密码，请点击以下链接..算了吧，反正没人会这么做。
> 
> 问候，
> 
> 超级网络服务

人类的坏习惯#1:在任何地方都使用相同的密码。我们都为此感到内疚。在您自己的收件箱中搜索您自己的密码。黑客 Croll 将 Gmail 帐户的密码重置为他发现的与用户订阅的某个随机网络服务相关的密码，该服务以明文形式发送了一个确认密码(他不止一次发现了同一个密码)。然后，他等待，检查用户仍然能够访问他们的帐户。不久之后，账户所有者的电子邮件账户中出现了明显的活动——阅读收到的电子邮件、发送回复和起草新邮件。账户所有人永远不会注意到一个完全陌生的人潜伏在背后。第二块多米诺骨牌倒下了。

从这里开始很容易。

黑客克罗尔现在筛选他可以访问的新信息集——使用来自该用户个人 Gmail 帐户的电子邮件来进一步填充他的目标信息地图。他将他的访问扩展到他找到的该用户已经注册的所有其他服务。在某些情况下，密码还是一样的——这让 Croll 进入了这个用户的工作邮箱账户，该账户托管在 Google Apps for Domains 上。结果是，这位员工(实际上是大多数/所有 Twitter 员工和其他所有人)在他们的 Google Apps 电子邮件(Twitter 电子邮件帐户)中使用了与他的个人 Gmail 帐户相同的密码。对于其他原始密码可能不起作用的网站，他利用了许多网站已经实现的帮助用户恢复密码的功能:臭名昭著的“秘密问题”。

暂时在这里岔开这个故事，因为这里有一个真正的“秘密问题”(从这里开始缩写为“秘密？”更合适).出于某种奇怪的原因，一些网站提到了“秘密？”作为一个额外的安全层-当它经常是完全相反的。在黑客克罗尔和 Twitter 的故事中，我们现在都知道的内部文件距离他获得的第一个帐户只有几步之遥。除此之外，这个攻击者，当然还有像他一样的其他人，已经能够证明 web 上一些最大和最流行的应用程序包含一些基本的弱点，这些弱点单独看起来可能是无害的，但是结合其他因素可以导致攻击者完全破坏用户的帐户，甚至是那些维护良好密码策略的用户。

这已经不是第一次提出“秘密？被用在密码恢复系统中。去年九月，美国共和党副总统候选人、前阿拉斯加州州长萨拉·佩林的个人雅虎邮箱账户截图被发布到了[维基解密](https://web.archive.org/web/20230306024837/http://wikileaks.org/wiki/Sarah_Palin_Yahoo_inbox_2008)。一个名为“匿名者”的黑客或组织声称对此次攻击负责，这次攻击是由攻击者在回答用于恢复密码的安全问题时做出有根据的猜测而实施的。2005 年初，名人帕丽斯·希尔顿遭遇了类似的事件，她的 T-Mobile sidekick 帐户被闯入，她的通话记录、信息(有些带有希尔顿的私人照片)和联系人名单的细节被泄露给了媒体。罪魁祸首还是“秘密？”。

让用户可以猜测宠物的名字，而不是知道密码，这大大降低了攻击者的胜算。该服务本质上是在告诉攻击者:“我们知道猜测密码很难，所以让我们帮助你将密码从潜在的数百万个组合缩小到十几个，或者更好，如果你知道如何谷歌，就一个”。问题不在于拥有一个额外的授权令牌的概念，例如母亲的娘家姓，除了密码之外，它还可以用来认证**，当它被单独依赖时，当答案被明文存储在帐户设置中时，以及当用户最终在他们的所有帐户上使用相同的问题和答案组合时，问题就出现了。**

从这一点来看，以一个个人账户为起点，入侵像病毒一样传播——感染 Twitter 内外许多不同服务的许多账户。一旦黑客 Croll 进入了谷歌托管的该员工的 Twitter 电子邮件帐户，他就能够下载包含大量敏感信息的电子邮件附件，包括更多的密码和用户名。他很快接管了至少三名高管的账户，包括伊万·威廉姆斯和比兹·斯通。细读他们的电子邮件附件导致更多敏感数据被下载。

然后，他搜索并访问了美国电话电报公司的电话记录，亚马逊的购买历史，MobileMe 的更多个人电子邮件和 iTunes 的完整信用卡信息(iTunes 有一个安全漏洞，以明文显示信用卡信息——我们已经通知了苹果，但没有收到回复，所以我们现在不会公布仍然开放的漏洞)。

基本上，当他完成后，黑客克罗尔有足够的 Twitter 关键高管的个人和工作信息，使他们的生活成为一个活生生的地狱。

总结一下这次攻击:

1.  HC 使用密码恢复功能为一名 Twitter 员工访问 Gmail，该功能会向第二封电子邮件发送一个重置链接。在这种情况下，第二个电子邮件是一个过期的 Hotmail 帐户，他只需注册它，点击链接并重置密码。Gmail 当时被拥有。
2.  然后，HC 阅读电子邮件，成功猜测 Gmail 的原始密码，并重置密码，这样 Twitter 员工就不会注意到帐户已更改。
3.  然后，HC 使用相同的密码访问该员工在 Google Apps 上的 Twitter 电子邮件，从而从电子邮件(尤其是电子邮件附件)中获取了大量敏感的公司信息。
4.  然后，HC 使用这些信息以及额外的密码猜测和重置来控制其他 Twitter 员工的个人和工作电子邮件。
5.  然后，HC 使用相同的用户名/密码组合和密码重置功能来访问美国电话电报公司、MobileMe、亚马逊和 iTunes 等服务。iTunes 中的一个安全漏洞使得 HC 能够以明文形式访问完整的信用卡信息。慧聪现在也控制了 Twitter 在 GoDaddy 的域名。
6.  即使在这一点上，Twitter 完全不知道他们已经妥协了。

接下来可能发生的是，黑客克罗尔可能使用或出售这些信息来获利。他没有那样做，并说他从来没有打算这样做。他说，他想做的只是强调 Twitter 数据安全政策的弱点，并让他们和其他初创公司考虑更强大的安全措施。

他还说，他很抱歉给 Twitter 带来这么多麻烦。我们问 Hacker Croll，他是否有什么想在 Twitter 上发布的消息，他给我发来了以下内容:

> 我向推特的工作人员道歉。我想这家公司有很好的前景。
> 
> 我在一个不幸运的地方。安全是我多年来最热衷的一个领域，我希望我的朋友也能来。每天，我都会和那些对抗网络威胁的人们一起到达。我很喜欢这个基地..举个例子:把注意力集中在一个小团体上，作家们把注意力集中在电视上，而把注意力集中在键盘上。我们的产品保证能够有效地抵御病毒、外部攻击、垃圾邮件、网络钓鱼……目前的系统开发、逻辑工具的使用……在欧盟也没有类似的方法。换尿布的人……没有人在纵坐标上储存机密信息……
> 
> 我希望我的干预能让一个恶意的人在不知情的情况下获得敏感的信息。
> 
> 黑客克罗尔。

这大致可以解释为:

> 我想向 Twitter 表示我个人的歉意。我认为这家公司前途无量。
> 
> 我这样做不是为了从信息中获利。安全是一个让我着迷多年的领域，我想做好我的工作。在我的日常生活中，我帮助人们防范互联网的危险。我学会了基本规则..例如:注意你点击下载文件的位置和你在键盘上输入的内容。确保计算机配备了有效的保护措施，可以抵御病毒、外部攻击、垃圾邮件、网络钓鱼…升级操作系统、常用软件…记住使用密码时不要有任何相似之处。记得定期更换它们…千万不要在电脑上存储机密信息…
> 
> 我希望我的干预将被重复，以显示一个恶意的人在没有太多知识的情况下获得敏感信息是多么容易。
> 
> 克罗尔·哈克。

从这一切中有什么收获？云服务既方便又便宜，还能帮助公司更快发展。但安全基础设施仍处于萌芽状态。尽管任何单一服务都可能相当安全，但重要的是，生态系统肯定不是这样。把这么多关于个人的个人信息在网上很容易找到的事实和大多数人已经把他们的工作和个人身份结合起来的现实结合起来，你就有了一个问题的种子。一个 Gmail 账户崩溃，很快整个创业公司的安全完整性就会崩溃。因此，首先，重置这些密码，不要对不同的服务使用相同的密码。不要使用可以通过简单的网络搜索轻松回答的密码恢复问题(一个简单的解决方案是错误地回答这些问题)。总的来说，要对数据安全保持警惕。你可能很高兴你是。